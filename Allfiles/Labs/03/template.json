{
    "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
    "contentVersion": "1.0.0.0",
    "parameters": {

    },
    "variables": {
        "uniqueSuffix": "[uniqueString(resourceGroup().id)]"
    },
    "resources": [
        {
            "type": "Microsoft.Authorization/roleAssignments",
            "apiVersion": "2020-04-01-preview",
            "name": "b7e6dc6d-f1e8-4753-8033-0f276bb0955b",
            "scope": "[concat('Microsoft.Storage/storageAccounts', '/', 'storage', variables('uniqueSuffix'))]",
            "dependsOn": [
                "[resourceId('Microsoft.Storage/storageAccounts', concat('storage', variables('uniqueSuffix')))]",
                "[resourceId('Microsoft.Purview/accounts', concat('main', variables('uniqueSuffix')))]"
            ],
            "properties": {
                "roleDefinitionId": "[concat(subscription().id, '/providers/Microsoft.Authorization/roleDefinitions/', 'b7e6dc6d-f1e8-4753-8033-0f276bb0955b')]",
                "principalId": "[reference(resourceId('Microsoft.Purview/accounts', concat('main', variables('uniqueSuffix'))),'2021-12-01', 'full').identity.principalId]"
            }
        },
        {
            "type": "Microsoft.Purview/accounts",
            "apiVersion": "2021-12-01",
            "name": "[concat('main', variables('uniqueSuffix'))]",
            "location": "[resourceGroup().location]",
            "sku": {
                "name": "Standard",
                "capacity": 1
            },
            "identity": {
                "type": "SystemAssigned"
            },
            "properties": {
                "cloudConnectors": {},
                "publicNetworkAccess": "Enabled",
                "managedResourceGroupName": "[concat('managed-rg-', variables('uniqueSuffix'))]"
            }
        },
        {
            "type": "Microsoft.KeyVault/vaults",
            "apiVersion": "2021-06-01-preview",
            "name": "[concat('main', variables('uniqueSuffix'))]",
            "location": "[resourceGroup().location]",
            "dependsOn": [
                "[resourceId('Microsoft.Purview/accounts', concat('main', variables('uniqueSuffix')))]"
            ],
            "properties": {
              "sku": { "family": "A", "name": "standard" },
              "tenantId": "[subscription().tenantId]",
              "accessPolicies": [{
                "tenantId": "[subscription().tenantid]",
                "objectId": "[reference(resourceId('Microsoft.Purview/accounts', concat('main', variables('uniqueSuffix'))),'2021-12-01', 'full').identity.principalId]",
                "permissions": {
                  "keys": [],
                  "secrets": [
                    "get",
                    "list",
                    "set"
                  ],
                  "certificates": []
                }
              }],
              "enabledForDeployment": true,
              "enabledForDiskEncryption": true,
              "enabledForTemplateDeployment": true,
              "enableSoftDelete": true
            }
          },
        {
            "type": "Microsoft.DataFactory/factories",
            "apiVersion": "2018-06-01",
            "name": "[concat('main', variables('uniqueSuffix'))]",
            "location": "[resourceGroup().location]",
            "identity": {
              "type": "SystemAssigned"
            }
        },
        {
            "type": "Microsoft.Network/privateDnsZones",
            "apiVersion": "2018-09-01",
            "name": "privatelink.blob.core.windows.net",
            "location": "global",
            "properties": {
                "maxNumberOfRecordSets": 25000,
                "maxNumberOfVirtualNetworkLinks": 1000,
                "maxNumberOfVirtualNetworkLinksWithRegistration": 100,
                "numberOfRecordSets": 2,
                "numberOfVirtualNetworkLinks": 0,
                "numberOfVirtualNetworkLinksWithRegistration": 0
            }
        },
        {
            "type": "Microsoft.Network/privateDnsZones",
            "apiVersion": "2018-09-01",
            "name": "privatelink.purview.azure.com",
            "location": "global",
            "properties": {
                "maxNumberOfRecordSets": 25000,
                "maxNumberOfVirtualNetworkLinks": 1000,
                "maxNumberOfVirtualNetworkLinksWithRegistration": 100,
                "numberOfRecordSets": 2,
                "numberOfVirtualNetworkLinks": 0,
                "numberOfVirtualNetworkLinksWithRegistration": 0
            }
        },
        {
            "type": "Microsoft.Network/privateDnsZones",
            "apiVersion": "2018-09-01",
            "name": "privatelink.purviewstudio.azure.com",
            "location": "global",
            "properties": {
                "maxNumberOfRecordSets": 25000,
                "maxNumberOfVirtualNetworkLinks": 1000,
                "maxNumberOfVirtualNetworkLinksWithRegistration": 100,
                "numberOfRecordSets": 2,
                "numberOfVirtualNetworkLinks": 0,
                "numberOfVirtualNetworkLinksWithRegistration": 0
            }
        },
        {
            "type": "Microsoft.Network/privateDnsZones",
            "apiVersion": "2018-09-01",
            "name": "privatelink.queue.core.windows.net",
            "location": "global",
            "properties": {
                "maxNumberOfRecordSets": 25000,
                "maxNumberOfVirtualNetworkLinks": 1000,
                "maxNumberOfVirtualNetworkLinksWithRegistration": 100,
                "numberOfRecordSets": 2,
                "numberOfVirtualNetworkLinks": 0,
                "numberOfVirtualNetworkLinksWithRegistration": 0
            }
        },
        {
            "type": "Microsoft.Network/privateDnsZones",
            "apiVersion": "2018-09-01",
            "name": "privatelink.servicebus.windows.net",
            "location": "global",
            "properties": {
                "maxNumberOfRecordSets": 25000,
                "maxNumberOfVirtualNetworkLinks": 1000,
                "maxNumberOfVirtualNetworkLinksWithRegistration": 100,
                "numberOfRecordSets": 2,
                "numberOfVirtualNetworkLinks": 0,
                "numberOfVirtualNetworkLinksWithRegistration": 0,
                "provisioningState": "Succeeded"
            }
        },
        {
            "type": "Microsoft.Network/virtualNetworks",
            "apiVersion": "2020-11-01",
            "name": "purview-vnet",
            "location": "[resourceGroup().location]",
            "properties": {
                "addressSpace": {
                    "addressPrefixes": [
                        "10.1.0.0/16"
                    ]
                },
                "subnets": [
                    {
                        "name": "default",
                        "properties": {
                            "addressPrefix": "10.1.0.0/24",
                            "delegations": [],
                            "privateEndpointNetworkPolicies": "Disabled",
                            "privateLinkServiceNetworkPolicies": "Enabled"
                        }
                    },
                    {
                        "name": "vms",
                        "properties": {
                            "addressPrefix": "10.1.1.0/24",
                            "serviceEndpoints": [],
                            "delegations": [],
                            "privateEndpointNetworkPolicies": "Disabled",
                            "privateLinkServiceNetworkPolicies": "Enabled"
                        }
                    }
                ],
                "virtualNetworkPeerings": [],
                "enableDdosProtection": false
            }
        },
        {
            "type": "Microsoft.Storage/storageAccounts",
            "apiVersion": "2021-09-01",
            "name": "[concat('storage', variables('uniqueSuffix'))]",
            "location": "[resourceGroup().location]",
            "sku": {
                "name": "Standard_RAGRS",
                "tier": "Standard"
            },
            "kind": "StorageV2",
            "properties": {
                "defaultToOAuthAuthentication": false,
                "publicNetworkAccess": "Enabled",
                "allowCrossTenantReplication": true,
                "minimumTlsVersion": "TLS1_2",
                "allowBlobPublicAccess": true,
                "allowSharedKeyAccess": true,
                "networkAcls": {
                    "bypass": "AzureServices",
                    "virtualNetworkRules": [],
                    "ipRules": [],
                    "defaultAction": "Allow"
                },
                "supportsHttpsTrafficOnly": true,
                "encryption": {
                    "requireInfrastructureEncryption": false,
                    "services": {
                        "file": {
                            "keyType": "Account",
                            "enabled": true
                        },
                        "blob": {
                            "keyType": "Account",
                            "enabled": true
                        }
                    },
                    "keySource": "Microsoft.Storage"
                },
                "accessTier": "Hot"
            }
        },
        {
            "type": "Microsoft.Network/networkInterfaces",
            "apiVersion": "2020-11-01",
            "name": "account.nic.74a776cd-4e8a-424e-8ae3-33a814e1146c",
            "location": "[resourceGroup().location]",
            "dependsOn": [
                "[resourceId('Microsoft.Network/virtualNetworks/subnets', 'purview-vnet', 'default')]"
            ],
            "properties": {
                "ipConfigurations": [
                    {
                        "name": "privateEndpointIpConfig.a7017168-6c69-41cb-9e09-41c595254f5c",
                        "properties": {
                            "privateIPAddress": "10.1.0.4",
                            "privateIPAllocationMethod": "Dynamic",
                            "subnet": {
                                "id": "[resourceId('Microsoft.Network/virtualNetworks/subnets', 'purview-vnet', 'default')]"
                            },
                            "primary": true,
                            "privateIPAddressVersion": "IPv4"
                        }
                    }
                ],
                "dnsSettings": {
                    "dnsServers": []
                },
                "enableIPForwarding": false
            }
        },
        {
            "type": "Microsoft.Network/networkInterfaces",
            "apiVersion": "2020-11-01",
            "name": "ingest-blob.nic.759c500c-1b82-4678-83ef-c9e65a12b2bf",
            "location": "[resourceGroup().location]",
            "dependsOn": [
                "[resourceId('Microsoft.Network/virtualNetworks/subnets', 'purview-vnet', 'default')]"
            ],
            "properties": {
                "ipConfigurations": [
                    {
                        "name": "privateEndpointIpConfig.ee3122db-f057-40f3-9278-85343dc6ac9a",
                        "properties": {
                            "privateIPAddress": "10.1.1.4",
                            "privateIPAllocationMethod": "Dynamic",
                            "subnet": {
                                "id": "[resourceId('Microsoft.Network/virtualNetworks/subnets', 'purview-vnet', 'default')]"
                            },
                            "primary": true,
                            "privateIPAddressVersion": "IPv4"
                        }
                    }
                ],
                "dnsSettings": {
                    "dnsServers": []
                },
                "enableIPForwarding": false
            }
        },
        {
            "type": "Microsoft.Network/networkInterfaces",
            "apiVersion": "2020-11-01",
            "name": "ingest-namespace.nic.d3b8642b-40a8-4833-97c9-842d335b053b",
            "location": "[resourceGroup().location]",
            "dependsOn": [
                "[resourceId('Microsoft.Network/virtualNetworks/subnets', 'purview-vnet', 'default')]"
            ],
            "properties": {
                "ipConfigurations": [
                    {
                        "name": "privateEndpointIpConfig.86ea1a36-5702-4e9e-aeab-355cf3a3829c",
                        "properties": {
                            "privateIPAddress": "10.1.1.6",
                            "privateIPAllocationMethod": "Dynamic",
                            "subnet": {
                                "id": "[resourceId('Microsoft.Network/virtualNetworks/subnets', 'purview-vnet', 'default')]"
                            },
                            "primary": true,
                            "privateIPAddressVersion": "IPv4"
                        }
                    }
                ],
                "dnsSettings": {
                    "dnsServers": []
                },
                "enableIPForwarding": false
            }
        },
        {
            "type": "Microsoft.Network/networkInterfaces",
            "apiVersion": "2020-11-01",
            "name": "ingest-queue.nic.0da4e1c0-dd37-46c4-963c-5f9929b099c5",
            "location": "[resourceGroup().location]",
            "dependsOn": [
                "[resourceId('Microsoft.Network/virtualNetworks/subnets', 'purview-vnet', 'default')]"
            ],
            "properties": {
                "ipConfigurations": [
                    {
                        "name": "privateEndpointIpConfig.deacab36-3167-4d16-80bf-b78687616e74",
                        "properties": {
                            "privateIPAddress": "10.1.1.5",
                            "privateIPAllocationMethod": "Dynamic",
                            "subnet": {
                                "id": "[resourceId('Microsoft.Network/virtualNetworks/subnets', 'purview-vnet', 'default')]"
                            },
                            "primary": true,
                            "privateIPAddressVersion": "IPv4"
                        }
                    }
                ],
                "dnsSettings": {
                    "dnsServers": []
                },
                "enableIPForwarding": false
            }
        },
        {
            "type": "Microsoft.Network/networkInterfaces",
            "apiVersion": "2020-11-01",
            "name": "portal.nic.f0e2c5cf-106d-4574-a077-74e986bfd210",
            "location": "[resourceGroup().location]",
            "dependsOn": [
                "[resourceId('Microsoft.Network/virtualNetworks/subnets', 'purview-vnet', 'default')]"
            ],
            "properties": {
                "ipConfigurations": [
                    {
                        "name": "privateEndpointIpConfig.368b0ecc-19ec-452f-afa4-98e78eb4ca89",
                        "properties": {
                            "privateIPAddress": "10.1.0.5",
                            "privateIPAllocationMethod": "Dynamic",
                            "subnet": {
                                "id": "[resourceId('Microsoft.Network/virtualNetworks/subnets', 'purview-vnet', 'default')]"
                            },
                            "primary": true,
                            "privateIPAddressVersion": "IPv4"
                        }
                    }
                ],
                "dnsSettings": {
                    "dnsServers": []
                },
                "enableIPForwarding": false
            }
        },
        {
            "type": "Microsoft.Network/privateDnsZones/A",
            "apiVersion": "2018-09-01",
            "name": "privatelink.blob.core.windows.net/scaneastuscoehhwx",
            "dependsOn": [
                "[resourceId('Microsoft.Network/privateDnsZones', 'privatelink.blob.core.windows.net')]"
            ],
            "properties": {
                "metadata": {
                    "creator": "created by private endpoint ingest-blob with resource guid 4368c814-8a6b-4704-bc01-1e802c30a95f"
                },
                "ttl": 10,
                "aRecords": [
                    {
                        "ipv4Address": "10.1.1.4"
                    }
                ]
            }
        },
        {
            "type": "Microsoft.Network/privateDnsZones/A",
            "apiVersion": "2018-09-01",
            "name": "[concat('privatelink.purview.azure.com/main-', variables('uniqueSuffix'))]",
            "dependsOn": [
                "[resourceId('Microsoft.Network/privateDnsZones', 'privatelink.purview.azure.com')]"
            ],
            "properties": {
                "metadata": {
                    "creator": "created by private endpoint account with resource guid 7a15702f-4b49-4115-9c7b-bfda1ca49cf4"
                },
                "ttl": 10,
                "aRecords": [
                    {
                        "ipv4Address": "10.1.0.4"
                    }
                ]
            }
        },
        {
            "type": "Microsoft.Network/privateDnsZones/A",
            "apiVersion": "2018-09-01",
            "name": "privatelink.purviewstudio.azure.com/web",
            "dependsOn": [
                "[resourceId('Microsoft.Network/privateDnsZones', 'privatelink.purviewstudio.azure.com')]"
            ],
            "properties": {
                "metadata": {
                    "creator": "created by private endpoint portal with resource guid 853d3873-6699-4982-a7d9-7b4c221182a9"
                },
                "ttl": 10,
                "aRecords": [
                    {
                        "ipv4Address": "10.1.0.5"
                    }
                ]
            }
        },
        {
            "type": "Microsoft.Network/privateDnsZones/A",
            "apiVersion": "2018-09-01",
            "name": "privatelink.queue.core.windows.net/scaneastuscoehhwx",
            "dependsOn": [
                "[resourceId('Microsoft.Network/privateDnsZones', 'privatelink.queue.core.windows.net')]"
            ],
            "properties": {
                "metadata": {
                    "creator": "created by private endpoint ingest-queue with resource guid feff3745-95fc-45b4-b107-89065198490d"
                },
                "ttl": 10,
                "aRecords": [
                    {
                        "ipv4Address": "10.1.1.5"
                    }
                ]
            }
        },
        {
            "type": "Microsoft.Network/privateDnsZones/A",
            "apiVersion": "2018-09-01",
            "name": "privatelink.servicebus.windows.net/atlas-b0cd2089-212b-4be6-a7b0-ebcd65f88802",
            "dependsOn": [
                "[resourceId('Microsoft.Network/privateDnsZones', 'privatelink.servicebus.windows.net')]"
            ],
            "properties": {
                "metadata": {
                    "creator": "created by private endpoint ingest-namespace with resource guid 706d2a87-84ad-4019-9487-bb374799d94e"
                },
                "ttl": 10,
                "aRecords": [
                    {
                        "ipv4Address": "10.1.1.6"
                    }
                ]
            }
        },
        {
            "type": "Microsoft.Network/privateDnsZones/SOA",
            "apiVersion": "2018-09-01",
            "name": "privatelink.blob.core.windows.net/@",
            "dependsOn": [
                "[resourceId('Microsoft.Network/privateDnsZones', 'privatelink.blob.core.windows.net')]"
            ],
            "properties": {
                "ttl": 3600,
                "soaRecord": {
                    "email": "azureprivatedns-host.microsoft.com",
                    "expireTime": 2419200,
                    "host": "azureprivatedns.net",
                    "minimumTtl": 10,
                    "refreshTime": 3600,
                    "retryTime": 300,
                    "serialNumber": 1
                }
            }
        },
        {
            "type": "Microsoft.Network/privateDnsZones/SOA",
            "apiVersion": "2018-09-01",
            "name": "privatelink.purview.azure.com/@",
            "dependsOn": [
                "[resourceId('Microsoft.Network/privateDnsZones', 'privatelink.purview.azure.com')]"
            ],
            "properties": {
                "ttl": 3600,
                "soaRecord": {
                    "email": "azureprivatedns-host.microsoft.com",
                    "expireTime": 2419200,
                    "host": "azureprivatedns.net",
                    "minimumTtl": 10,
                    "refreshTime": 3600,
                    "retryTime": 300,
                    "serialNumber": 1
                }
            }
        },
        {
            "type": "Microsoft.Network/privateDnsZones/SOA",
            "apiVersion": "2018-09-01",
            "name": "privatelink.purviewstudio.azure.com/@",
            "dependsOn": [
                "[resourceId('Microsoft.Network/privateDnsZones', 'privatelink.purviewstudio.azure.com')]"
            ],
            "properties": {
                "ttl": 3600,
                "soaRecord": {
                    "email": "azureprivatedns-host.microsoft.com",
                    "expireTime": 2419200,
                    "host": "azureprivatedns.net",
                    "minimumTtl": 10,
                    "refreshTime": 3600,
                    "retryTime": 300,
                    "serialNumber": 1
                }
            }
        },
        {
            "type": "Microsoft.Network/privateDnsZones/SOA",
            "apiVersion": "2018-09-01",
            "name": "privatelink.queue.core.windows.net/@",
            "dependsOn": [
                "[resourceId('Microsoft.Network/privateDnsZones', 'privatelink.queue.core.windows.net')]"
            ],
            "properties": {
                "ttl": 3600,
                "soaRecord": {
                    "email": "azureprivatedns-host.microsoft.com",
                    "expireTime": 2419200,
                    "host": "azureprivatedns.net",
                    "minimumTtl": 10,
                    "refreshTime": 3600,
                    "retryTime": 300,
                    "serialNumber": 1
                }
            }
        },
        {
            "type": "Microsoft.Network/privateDnsZones/SOA",
            "apiVersion": "2018-09-01",
            "name": "privatelink.servicebus.windows.net/@",
            "dependsOn": [
                "[resourceId('Microsoft.Network/privateDnsZones', 'privatelink.servicebus.windows.net')]"
            ],
            "properties": {
                "ttl": 3600,
                "soaRecord": {
                    "email": "azureprivatedns-host.microsoft.com",
                    "expireTime": 2419200,
                    "host": "azureprivatedns.net",
                    "minimumTtl": 10,
                    "refreshTime": 3600,
                    "retryTime": 300,
                    "serialNumber": 1
                }
            }
        },
        {
            "type": "Microsoft.Network/privateEndpoints",
            "apiVersion": "2020-11-01",
            "name": "ingest-blob",
            "location": "[resourceGroup().location]",
            "dependsOn": [
                "[resourceId('Microsoft.Network/virtualNetworks/subnets', 'purview-vnet', 'default')]"
            ],
            "properties": {
                "privateLinkServiceConnections": [
                    {
                        "name": "ingest-blob",
                        "properties": {
                            "privateLinkServiceId": "/subscriptions/e433f371-e5e9-4238-abc2-7c38aa596a18/resourceGroups/managed-rg-qhtkrbj/providers/Microsoft.Storage/storageAccounts/scaneastuscoehhwx",
                            "groupIds": [
                                "blob"
                            ],
                            "privateLinkServiceConnectionState": {
                                "status": "Approved",
                                "description": "Auto-Approved",
                                "actionsRequired": "None"
                            }
                        }
                    }
                ],
                "manualPrivateLinkServiceConnections": [],
                "subnet": {
                    "id": "[resourceId('Microsoft.Network/virtualNetworks/subnets', 'purview-vnet', 'default')]"
                },
                "customDnsConfigs": []
            }
        },
        {
            "type": "Microsoft.Network/privateEndpoints",
            "apiVersion": "2020-11-01",
            "name": "ingest-namespace",
            "location": "[resourceGroup().location]",
            "dependsOn": [
                "[resourceId('Microsoft.Network/virtualNetworks/subnets', 'purview-vnet', 'default')]"
            ],
            "properties": {
                "privateLinkServiceConnections": [
                    {
                        "name": "ingest-namespace",
                        "properties": {
                            "privateLinkServiceId": "/subscriptions/e433f371-e5e9-4238-abc2-7c38aa596a18/resourceGroups/managed-rg-qhtkrbj/providers/Microsoft.EventHub/namespaces/Atlas-b0cd2089-212b-4be6-a7b0-ebcd65f88802",
                            "groupIds": [
                                "namespace"
                            ],
                            "privateLinkServiceConnectionState": {
                                "status": "Approved",
                                "description": "Auto-Approved",
                                "actionsRequired": "None"
                            }
                        }
                    }
                ],
                "manualPrivateLinkServiceConnections": [],
                "subnet": {
                    "id": "[resourceId('Microsoft.Network/virtualNetworks/subnets', 'purview-vnet', 'default')]"
                },
                "customDnsConfigs": []
            }
        },
        {
            "type": "Microsoft.Network/privateEndpoints",
            "apiVersion": "2020-11-01",
            "name": "ingest-queue",
            "location": "[resourceGroup().location]",
            "dependsOn": [
                "[resourceId('Microsoft.Network/virtualNetworks/subnets', 'purview-vnet', 'default')]"
            ],
            "properties": {
                "privateLinkServiceConnections": [
                    {
                        "name": "ingest-queue",
                        "properties": {
                            "privateLinkServiceId": "/subscriptions/e433f371-e5e9-4238-abc2-7c38aa596a18/resourceGroups/managed-rg-qhtkrbj/providers/Microsoft.Storage/storageAccounts/scaneastuscoehhwx",
                            "groupIds": [
                                "queue"
                            ],
                            "privateLinkServiceConnectionState": {
                                "status": "Approved",
                                "description": "Auto-Approved",
                                "actionsRequired": "None"
                            }
                        }
                    }
                ],
                "manualPrivateLinkServiceConnections": [],
                "subnet": {
                    "id": "[resourceId('Microsoft.Network/virtualNetworks/subnets', 'purview-vnet', 'default')]"
                },
                "customDnsConfigs": []
            }
        },
        {
            "type": "Microsoft.Network/virtualNetworks/subnets",
            "apiVersion": "2020-11-01",
            "name": "purview-vnet/default",
            "dependsOn": [
                "[resourceId('Microsoft.Network/virtualNetworks', 'purview-vnet')]"
            ],
            "properties": {
                "addressPrefix": "10.1.0.0/24",
                "delegations": [],
                "privateEndpointNetworkPolicies": "Disabled",
                "privateLinkServiceNetworkPolicies": "Enabled"
            }
        },
        {
            "type": "Microsoft.Network/virtualNetworks/subnets",
            "apiVersion": "2020-11-01",
            "name": "purview-vnet/vms",
            "dependsOn": [
                "[resourceId('Microsoft.Network/virtualNetworks', 'purview-vnet')]"
            ],
            "properties": {
                "addressPrefix": "10.1.1.0/24",
                "serviceEndpoints": [],
                "delegations": [],
                "privateEndpointNetworkPolicies": "Disabled",
                "privateLinkServiceNetworkPolicies": "Enabled"
            }
        },
        {
            "type": "Microsoft.Storage/storageAccounts/blobServices",
            "apiVersion": "2021-09-01",
            "name": "[concat('storage', variables('uniqueSuffix'), '/default')]",
            "dependsOn": [
                "[resourceId('Microsoft.Storage/storageAccounts', concat('storage', variables('uniqueSuffix')))]"
            ],
            "sku": {
                "name": "Standard_RAGRS",
                "tier": "Standard"
            },
            "properties": {
                "changeFeed": {
                    "enabled": false
                },
                "restorePolicy": {
                    "enabled": false
                },
                "containerDeleteRetentionPolicy": {
                    "enabled": true,
                    "days": 7
                },
                "cors": {
                    "corsRules": []
                },
                "deleteRetentionPolicy": {
                    "allowPermanentDelete": false,
                    "enabled": true,
                    "days": 7
                },
                "isVersioningEnabled": false
            }
        },
        {
            "type": "Microsoft.Storage/storageAccounts/fileServices",
            "apiVersion": "2021-09-01",
            "name": "[concat('storage', variables('uniqueSuffix'), '/default')]",
            "dependsOn": [
                "[resourceId('Microsoft.Storage/storageAccounts', concat('storage', variables('uniqueSuffix')))]"
            ],
            "sku": {
                "name": "Standard_RAGRS",
                "tier": "Standard"
            },
            "properties": {
                "shareDeleteRetentionPolicy": {
                    "enabled": true,
                    "days": 7
                }
            }
        },
        {
            "type": "Microsoft.Storage/storageAccounts/queueServices",
            "apiVersion": "2021-09-01",
            "name": "[concat('storage', variables('uniqueSuffix'), '/default')]",
            "dependsOn": [
                "[resourceId('Microsoft.Storage/storageAccounts', concat('storage', variables('uniqueSuffix')))]"
            ],
            "properties": {
                "cors": {
                    "corsRules": []
                }
            }
        },
        {
            "type": "Microsoft.Storage/storageAccounts/tableServices",
            "apiVersion": "2021-09-01",
            "name": "[concat('storage', variables('uniqueSuffix'), '/default')]",
            "dependsOn": [
                "[resourceId('Microsoft.Storage/storageAccounts', concat('storage', variables('uniqueSuffix')))]"
            ],
            "properties": {
                "cors": {
                    "corsRules": []
                }
            }
        },
        {
            "type": "Microsoft.Network/privateDnsZones/virtualNetworkLinks",
            "apiVersion": "2018-09-01",
            "name": "privatelink.blob.core.windows.net/oww4mwflxof22",
            "location": "global",
            "dependsOn": [
                "[resourceId('Microsoft.Network/privateDnsZones', 'privatelink.blob.core.windows.net')]",
                "[resourceId('Microsoft.Network/virtualNetworks', 'purview-vnet')]"
            ],
            "properties": {
                "registrationEnabled": false,
                "virtualNetwork": {
                    "id": "[resourceId('Microsoft.Network/virtualNetworks', 'purview-vnet')]"
                }
            }
        },
        {
            "type": "Microsoft.Network/privateDnsZones/virtualNetworkLinks",
            "apiVersion": "2018-09-01",
            "name": "privatelink.purview.azure.com/oww4mwflxof22",
            "location": "global",
            "dependsOn": [
                "[resourceId('Microsoft.Network/privateDnsZones', 'privatelink.purview.azure.com')]",
                "[resourceId('Microsoft.Network/virtualNetworks', 'purview-vnet')]"
            ],
            "properties": {
                "registrationEnabled": false,
                "virtualNetwork": {
                    "id": "[resourceId('Microsoft.Network/virtualNetworks', 'purview-vnet')]"
                }
            }
        },
        {
            "type": "Microsoft.Network/privateDnsZones/virtualNetworkLinks",
            "apiVersion": "2018-09-01",
            "name": "privatelink.purviewstudio.azure.com/oww4mwflxof22",
            "location": "global",
            "dependsOn": [
                "[resourceId('Microsoft.Network/privateDnsZones', 'privatelink.purviewstudio.azure.com')]",
                "[resourceId('Microsoft.Network/virtualNetworks', 'purview-vnet')]"
            ],
            "properties": {
                "registrationEnabled": false,
                "virtualNetwork": {
                    "id": "[resourceId('Microsoft.Network/virtualNetworks', 'purview-vnet')]"
                }
            }
        },
        {
            "type": "Microsoft.Network/privateDnsZones/virtualNetworkLinks",
            "apiVersion": "2018-09-01",
            "name": "privatelink.queue.core.windows.net/oww4mwflxof22",
            "location": "global",
            "dependsOn": [
                "[resourceId('Microsoft.Network/privateDnsZones', 'privatelink.queue.core.windows.net')]",
                "[resourceId('Microsoft.Network/virtualNetworks', 'purview-vnet')]"
            ],
            "properties": {
                "registrationEnabled": false,
                "virtualNetwork": {
                    "id": "[resourceId('Microsoft.Network/virtualNetworks', 'purview-vnet')]"
                }
            }
        },
        {
            "type": "Microsoft.Network/privateDnsZones/virtualNetworkLinks",
            "apiVersion": "2018-09-01",
            "name": "privatelink.servicebus.windows.net/oww4mwflxof22",
            "location": "global",
            "dependsOn": [
                "[resourceId('Microsoft.Network/privateDnsZones', 'privatelink.servicebus.windows.net')]",
                "[resourceId('Microsoft.Network/virtualNetworks', 'purview-vnet')]"
            ],
            "properties": {
                "registrationEnabled": false,
                "virtualNetwork": {
                    "id": "[resourceId('Microsoft.Network/virtualNetworks', 'purview-vnet')]"
                }
            }
        },
        {
            "type": "Microsoft.Network/privateEndpoints",
            "apiVersion": "2020-11-01",
            "name": "account",
            "location": "[resourceGroup().location]",
            "dependsOn": [
                "[resourceId('Microsoft.Purview/accounts', concat('main', variables('uniqueSuffix')))]",
                "[resourceId('Microsoft.Network/virtualNetworks/subnets', 'purview-vnet', 'default')]"
            ],
            "properties": {
                "privateLinkServiceConnections": [
                    {
                        "name": "account",
                        "properties": {
                            "privateLinkServiceId": "[resourceId('Microsoft.Purview/accounts', concat('main', variables('uniqueSuffix')))]",
                            "groupIds": [
                                "account"
                            ],
                            "privateLinkServiceConnectionState": {
                                "status": "Approved",
                                "description": "Auto-Approved",
                                "actionsRequired": "None"
                            }
                        }
                    }
                ],
                "manualPrivateLinkServiceConnections": [],
                "subnet": {
                    "id": "[resourceId('Microsoft.Network/virtualNetworks/subnets', 'purview-vnet', 'default')]"
                },
                "customDnsConfigs": []
            }
        },
        {
            "type": "Microsoft.Network/privateEndpoints",
            "apiVersion": "2020-11-01",
            "name": "portal",
            "location": "[resourceGroup().location]",
            "dependsOn": [
                "[resourceId('Microsoft.Purview/accounts', concat('main', variables('uniqueSuffix')))]",
                "[resourceId('Microsoft.Network/virtualNetworks/subnets', 'purview-vnet', 'default')]"
            ],
            "properties": {
                "privateLinkServiceConnections": [
                    {
                        "name": "portal",
                        "properties": {
                            "privateLinkServiceId": "[resourceId('Microsoft.Purview/accounts', concat('main', variables('uniqueSuffix')))]",
                            "groupIds": [
                                "portal"
                            ],
                            "privateLinkServiceConnectionState": {
                                "status": "Approved",
                                "description": "Auto-Approved",
                                "actionsRequired": "None"
                            }
                        }
                    }
                ],
                "manualPrivateLinkServiceConnections": [],
                "subnet": {
                    "id": "[resourceId('Microsoft.Network/virtualNetworks/subnets', 'purview-vnet', 'default')]"
                },
                "customDnsConfigs": []
            }
        },
        {
            "type": "Microsoft.Network/privateEndpoints/privateDnsZoneGroups",
            "apiVersion": "2020-11-01",
            "name": "account/default",
            "dependsOn": [
                "[resourceId('Microsoft.Network/privateEndpoints', 'account')]",
                "[resourceId('Microsoft.Network/privateDnsZones', 'privatelink.purview.azure.com')]"
            ],
            "properties": {
                "privateDnsZoneConfigs": [
                    {
                        "name": "privatelink-purview-azure-com",
                        "properties": {
                            "privateDnsZoneId": "[resourceId('Microsoft.Network/privateDnsZones', 'privatelink.purview.azure.com')]"
                        }
                    }
                ]
            }
        },
        {
            "type": "Microsoft.Network/privateEndpoints/privateDnsZoneGroups",
            "apiVersion": "2020-11-01",
            "name": "ingest-blob/default",
            "dependsOn": [
                "[resourceId('Microsoft.Network/privateEndpoints', 'ingest-blob')]",
                "[resourceId('Microsoft.Network/privateDnsZones', 'privatelink.blob.core.windows.net')]"
            ],
            "properties": {
                "privateDnsZoneConfigs": [
                    {
                        "name": "privatelink-blob-core-windows-net",
                        "properties": {
                            "privateDnsZoneId": "[resourceId('Microsoft.Network/privateDnsZones', 'privatelink.blob.core.windows.net')]"
                        }
                    }
                ]
            }
        },
        {
            "type": "Microsoft.Network/privateEndpoints/privateDnsZoneGroups",
            "apiVersion": "2020-11-01",
            "name": "ingest-namespace/default",
            "dependsOn": [
                "[resourceId('Microsoft.Network/privateEndpoints', 'ingest-namespace')]",
                "[resourceId('Microsoft.Network/privateDnsZones', 'privatelink.servicebus.windows.net')]"
            ],
            "properties": {
                "privateDnsZoneConfigs": [
                    {
                        "name": "privatelink-servicebus-windows-net",
                        "properties": {
                            "privateDnsZoneId": "[resourceId('Microsoft.Network/privateDnsZones', 'privatelink.servicebus.windows.net')]"
                        }
                    }
                ]
            }
        },
        {
            "type": "Microsoft.Network/privateEndpoints/privateDnsZoneGroups",
            "apiVersion": "2020-11-01",
            "name": "ingest-queue/default",
            "dependsOn": [
                "[resourceId('Microsoft.Network/privateEndpoints', 'ingest-queue')]",
                "[resourceId('Microsoft.Network/privateDnsZones', 'privatelink.queue.core.windows.net')]"
            ],
            "properties": {
                "privateDnsZoneConfigs": [
                    {
                        "name": "privatelink-queue-core-windows-net",
                        "properties": {
                            "privateDnsZoneId": "[resourceId('Microsoft.Network/privateDnsZones', 'privatelink.queue.core.windows.net')]"
                        }
                    }
                ]
            }
        },
        {
            "type": "Microsoft.Network/privateEndpoints/privateDnsZoneGroups",
            "apiVersion": "2020-11-01",
            "name": "portal/default",
            "dependsOn": [
                "[resourceId('Microsoft.Network/privateEndpoints', 'portal')]",
                "[resourceId('Microsoft.Network/privateDnsZones', 'privatelink.purviewstudio.azure.com')]"
            ],
            "properties": {
                "privateDnsZoneConfigs": [
                    {
                        "name": "privatelink-purviewstudio-azure-com",
                        "properties": {
                            "privateDnsZoneId": "[resourceId('Microsoft.Network/privateDnsZones', 'privatelink.purviewstudio.azure.com')]"
                        }
                    }
                ]
            }
        },
        {
            "type": "Microsoft.Purview/accounts/privateEndpointConnections",
            "apiVersion": "2021-07-01",
            "name": "[concat('main', variables('uniqueSuffix'), '/account-c2774400-8195-4938-9f33-3e37589455ad')]",
            "dependsOn": [
                "[resourceId('Microsoft.Purview/accounts', concat('main', variables('uniqueSuffix')))]",
                "[resourceId('Microsoft.Network/privateEndpoints', 'account')]"
            ],
            "properties": {
                "privateEndpoint": {
                    "id": "[resourceId('Microsoft.Network/privateEndpoints', 'account')]"
                },
                "privateLinkServiceConnectionState": {
                    "status": "Approved",
                    "actionsRequired": "None"
                }
            }
        },
        {
            "type": "Microsoft.Purview/accounts/privateEndpointConnections",
            "apiVersion": "2021-07-01",
            "name": "[concat('main', variables('uniqueSuffix'), '/portal-db1549b8-bfd6-48ac-b593-b05e0f39ab7c')]",
            "dependsOn": [
                "[resourceId('Microsoft.Purview/accounts', concat('main', variables('uniqueSuffix')))]",
                "[resourceId('Microsoft.Network/privateEndpoints', 'portal')]"
            ],
            "properties": {
                "privateEndpoint": {
                    "id": "[resourceId('Microsoft.Network/privateEndpoints', 'portal')]"
                },
                "privateLinkServiceConnectionState": {
                    "status": "Approved",
                    "actionsRequired": "None"
                }
            }
        }
    ]
}